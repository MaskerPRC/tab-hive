# 工作流"上帝视角"模式

## 🎯 设计理念

工作流编辑器采用"上帝视角"设计 —— 一个悬浮在所有网页之上的透明调度层。

### 立体架构

```
┌─────────────────────────────────────────┐
│   上层：工作流调度层（半透明悬浮）      │ ← 上帝视角
│   - 可视化编辑节点和连接                │
│   - 实时调试和监控                      │
│   - 可调节透明度查看下层                │
└─────────────────────────────────────────┘
              ↓ 连接 ↓
┌─────────────────────────────────────────┐
│   下层：多个网页                        │
│   ┌─────────┐  ┌─────────┐             │
│   │ 网页A   │  │ 网页B   │             │
│   │         │  │         │             │
│   └─────────┘  └─────────┘             │
└─────────────────────────────────────────┘
```

## ✨ 核心特性

### 1. 半透明画布
- 默认透明度：70%
- 可以看到下方的网页内容
- 调节透明度滑块：30% - 100%
- 背景模糊效果：营造层次感

### 2. 悬浮节点
- 节点背景：98% 不透明度，确保可读性
- 毛玻璃效果：backdrop-filter 模糊
- 强阴影：突出节点与画布的层次关系
- 节点可拖动定位

### 3. 实时调试
- 执行工作流时可以看到下方网页的变化
- 数据提取实时显示
- 交互操作立即可见
- 执行日志记录所有步骤

### 4. 透明度控制
```
头部工具栏右侧：
[透明度] [━━━━○━━] [70%] [▶️ 测试运行] [💾 保存] [× 关闭]
          滑块
```

## 🎨 视觉设计

### 颜色层次
1. **背景遮罩**：`rgba(0, 0, 0, 0.3)` - 轻微变暗
2. **画布**：`rgba(250, 250, 250, 0.5)` - 半透明白色
3. **工具面板/头部**：`rgba(255, 255, 255, 0.98)` - 几乎不透明
4. **节点**：`rgba(255, 255, 255, 0.98)` - 几乎不透明
5. **网格线**：`rgba(224, 224, 224, 0.3)` - 淡化网格

### 特殊标识
- **上帝视角徽章**：紫色渐变 `#667eea → #764ba2`
- **提示文字**：黄色调 `#f57c00`
- **连接线**：
  - 数据映射（虚线）：蓝色 `#2196F3`
  - 执行流（实线）：绿色 `#4CAF50`

## 🔧 使用方法

### 1. 打开上帝视角
1. 点击网站卡片的"..." → "自动化工作流"
2. 工作流编辑器以半透明层覆盖在网页上
3. 可以透过画布看到下方的网页

### 2. 调整透明度
- 拖动头部的透明度滑块
- 降低透明度：更清晰看到下方网页
- 提高透明度：更清晰看到工作流节点

### 3. 编辑工作流
- 添加节点：左侧工具面板
- 选择元素：点击"🎯 选择元素"
- 连接节点：拖动端口创建连接
- 配置映射：点击选择器配置

### 4. 实时调试
1. 点击"▶️ 测试运行"
2. 观察底部执行日志
3. 同时观察下方网页的变化
4. 数据提取和交互都是实时的

## 💡 使用场景

### 场景1：Base64编码测试
```
上层：工作流编辑器
  - Flow节点：数据处理
  - Web Control节点：执行交互
  - 连接线：数据流和控制流

下层：base64encode.org 网页
  - 可以看到输入框
  - 可以看到编码按钮
  - 可以看到结果显示
  
执行时：
  ✓ 看到文本被输入
  ✓ 看到按钮被点击
  ✓ 看到结果出现
```

### 场景2：多网页协同
```
上层：工作流编辑器
  - 多个网页节点
  - 数据在网页间流转
  - 统一调度控制

下层：多个网页并排显示
  - 网页A：数据源
  - 网页B：处理器
  - 网页C：结果显示
```

## 🎯 优势

### 1. 可视化调试
- **传统方式**：执行后看日志，猜测发生了什么
- **上帝视角**：直接看到网页变化，所见即所得

### 2. 空间感知
- **传统方式**：节点图和网页分离，难以对应
- **上帝视角**：节点悬浮在对应网页上方，一目了然

### 3. 实时反馈
- **传统方式**：执行完才知道结果
- **上帝视角**：每一步都能实时观察

### 4. 多网页协同
- **传统方式**：难以理解多个网页的关系
- **上帝视角**：从上往下俯瞰全局，关系清晰

## 🚀 技术实现

### CSS关键技术
```css
/* 半透明悬浮层 */
.workflow-editor-overlay {
  background: rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(2px);
  pointer-events: none; /* 背景不捕获事件 */
}

/* 画布透明度可调 */
.canvas-area {
  background-color: rgba(250, 250, 250, 0.5);
  opacity: var(--canvas-opacity); /* 动态控制 */
}

/* 节点毛玻璃效果 */
.workflow-node {
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}
```

### 响应式透明度
```javascript
const canvasOpacity = ref(0.7) // 默认70%

// 绑定到画布
<div :style="{ opacity: canvasOpacity }">
```

## 📝 后续优化

### 近期
- [ ] 记忆透明度设置
- [ ] 快捷键切换透明度（0%/50%/100%）
- [ ] 画布缩放功能
- [ ] 小地图导航

### 远期
- [ ] 3D视角切换
- [ ] 多层级工作流
- [ ] 时间轴回放
- [ ] AR增强现实模式

## 🎉 总结

"上帝视角"模式将工作流编辑器从一个独立的界面，转变为一个悬浮在网页之上的智能调度层。这种设计：

1. ✅ **直观**：所见即所得，实时反馈
2. ✅ **高效**：无需切换界面，一步到位
3. ✅ **强大**：支持多网页协同调度
4. ✅ **灵活**：透明度可调，适应不同场景

这是一种**革命性的自动化工作流设计**，将抽象的流程图与具体的网页操作完美融合！

---

**版本**: 上帝视角 v1.0  
**日期**: 2025-12-13  
**理念**: 从上帝视角俯瞰和控制所有网页

