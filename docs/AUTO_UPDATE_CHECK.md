# è‡ªåŠ¨æ›´æ–°æ£€æµ‹åŠŸèƒ½

## åŠŸèƒ½æ¦‚è¿°

Tab Hive ç°å·²æ”¯æŒè‡ªåŠ¨æ›´æ–°æ£€æµ‹åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·åŠæ—¶äº†è§£æ–°ç‰ˆæœ¬çš„å‘å¸ƒå¹¶è¿›è¡Œå‡çº§ã€‚

## ä¸»è¦ç‰¹æ€§

### 1. è‡ªåŠ¨æ£€æµ‹æ—¶æœº
- **å¯åŠ¨æ—¶æ£€æµ‹**ï¼šåº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ˜¯å¦æœ‰æ–°ç‰ˆæœ¬
- **å®šæ—¶æ£€æµ‹**ï¼šæ¯24å°æ—¶è‡ªåŠ¨æ£€æµ‹ä¸€æ¬¡æ–°ç‰ˆæœ¬
- **æ™ºèƒ½é—´éš”**ï¼šæ ¹æ®ä¸Šæ¬¡æ£€æµ‹æ—¶é—´æ™ºèƒ½å†³å®šæ˜¯å¦éœ€è¦ç«‹å³æ£€æµ‹

### 2. ç‰ˆæœ¬ä¿¡æ¯æ¥æº
- é€šè¿‡ GitHub API è·å–æœ€æ–°çš„ release ä¿¡æ¯
- æ£€æµ‹åœ°å€ï¼š`https://api.github.com/repos/MaskerPRC/tab-hive/releases/latest`
- æ”¯æŒæ˜¾ç¤ºç‰ˆæœ¬å·ã€å‘å¸ƒè¯´æ˜ã€å‘å¸ƒæ—¶é—´ç­‰è¯¦ç»†ä¿¡æ¯

### 3. ç”¨æˆ·äº¤äº’

#### æ›´æ–°é€šçŸ¥å¼¹çª—
å½“æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸€ä¸ªä¼˜é›…çš„æ›´æ–°é€šçŸ¥å¼¹çª—ï¼ŒåŒ…å«ï¼š
- å½“å‰ç‰ˆæœ¬å’Œæœ€æ–°ç‰ˆæœ¬çš„å¯¹æ¯”
- æ›´æ–°å†…å®¹æ‘˜è¦ï¼ˆRelease Notesï¼‰
- ä¸‰ä¸ªæ“ä½œé€‰é¡¹ï¼š
  - **ç«‹å³æ›´æ–°**ï¼šè·³è½¬åˆ° GitHub Release é¡µé¢ä¸‹è½½
  - **ç¨åæé†’**ï¼šæš‚æ—¶å¿½ç•¥æ­¤ç‰ˆæœ¬ï¼Œåœ¨å·¦ä¾§æ æ˜¾ç¤ºæ›´æ–°æŒ‰é’®
  - **å…³é—­**ï¼šå…³é—­é€šçŸ¥ï¼ˆä¸‹æ¬¡æ£€æµ‹ä»ä¼šæç¤ºï¼‰

#### æ›´æ–°æŒ‰é’®
å¦‚æœç”¨æˆ·é€‰æ‹©"ç¨åæé†’"ï¼Œä¼šåœ¨å·¦ä¾§é…ç½®é¢æ¿åº•éƒ¨æ˜¾ç¤ºä¸€ä¸ªé†’ç›®çš„æ›´æ–°æŒ‰é’®ï¼š
- æ¸å˜è‰²èƒŒæ™¯ï¼Œæ˜“äºè¯†åˆ«
- å¸¦æœ‰åŠ¨ç”»æ•ˆæœçš„å›¾æ ‡
- å¸¦æœ‰è·³åŠ¨çš„ç»¿è‰²å°åœ†ç‚¹æç¤º
- ç‚¹å‡»å¯é‡æ–°æ˜¾ç¤ºæ›´æ–°é€šçŸ¥

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒæ–‡ä»¶

1. **`src/composables/useUpdateChecker.js`**
   - æ›´æ–°æ£€æµ‹çš„æ ¸å¿ƒé€»è¾‘
   - ç‰ˆæœ¬æ¯”è¾ƒç®—æ³•
   - GitHub API è°ƒç”¨
   - æœ¬åœ°å­˜å‚¨ç®¡ç†

2. **`src/components/UpdateNotification.vue`**
   - æ›´æ–°é€šçŸ¥å¼¹çª—ç»„ä»¶
   - ä¼˜é›…çš„ UI è®¾è®¡
   - Markdown æ ¼å¼çš„ Release Notes æ˜¾ç¤º

3. **`src/components/UpdateButton.vue`**
   - å·¦ä¾§æ æ›´æ–°æŒ‰é’®ç»„ä»¶
   - åŠ¨ç”»æ•ˆæœå’Œè§†è§‰æç¤º

### ç‰ˆæœ¬æ¯”è¾ƒç®—æ³•

```javascript
// æ¯”è¾ƒç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚ï¼š0.5.2 vs 0.0.1ï¼‰
const compareVersions = (v1, v2) => {
  const parts1 = v1.replace(/^v/, '').split('.').map(Number)
  const parts2 = v2.replace(/^v/, '').split('.').map(Number)
  
  for (let i = 0; i < Math.max(parts1.length, parts2.length); i++) {
    const part1 = parts1[i] || 0
    const part2 = parts2[i] || 0
    
    if (part1 > part2) return 1
    if (part1 < part2) return -1
  }
  
  return 0
}
```

### æœ¬åœ°å­˜å‚¨

ä½¿ç”¨ `localStorage` å­˜å‚¨ä»¥ä¸‹ä¿¡æ¯ï¼š
- `tab-hive-ignored-update-version`ï¼šç”¨æˆ·å¿½ç•¥çš„ç‰ˆæœ¬å·
- `tab-hive-last-update-check`ï¼šä¸Šæ¬¡æ£€æµ‹çš„æ—¶é—´æˆ³

### çŠ¶æ€ç®¡ç†

æ›´æ–°æ£€æµ‹å™¨ç»´æŠ¤ä»¥ä¸‹çŠ¶æ€ï¼š
- `currentVersion`ï¼šå½“å‰åº”ç”¨ç‰ˆæœ¬
- `latestVersion`ï¼šæœ€æ–°å¯ç”¨ç‰ˆæœ¬
- `updateAvailable`ï¼šæ˜¯å¦æœ‰æ–°ç‰ˆæœ¬å¯ç”¨
- `updateInfo`ï¼šæœ€æ–°ç‰ˆæœ¬çš„è¯¦ç»†ä¿¡æ¯
- `showUpdateNotification`ï¼šæ˜¯å¦æ˜¾ç¤ºæ›´æ–°é€šçŸ¥å¼¹çª—
- `showUpdateButton`ï¼šæ˜¯å¦åœ¨å·¦ä¾§æ æ˜¾ç¤ºæ›´æ–°æŒ‰é’®
- `isChecking`ï¼šæ˜¯å¦æ­£åœ¨æ£€æµ‹ä¸­
- `lastCheckTime`ï¼šä¸Šæ¬¡æ£€æµ‹æ—¶é—´

## ç”¨æˆ·æµç¨‹

### åœºæ™¯1ï¼šé¦–æ¬¡å¯åŠ¨æ£€æµ‹åˆ°æ›´æ–°
1. ç”¨æˆ·å¯åŠ¨åº”ç”¨
2. ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹æ›´æ–°
3. å‘ç°æ–°ç‰ˆæœ¬ v0.5.2
4. æ˜¾ç¤ºæ›´æ–°é€šçŸ¥å¼¹çª—
5. ç”¨æˆ·é€‰æ‹©"ç«‹å³æ›´æ–°"
6. è·³è½¬åˆ° GitHub Release é¡µé¢

### åœºæ™¯2ï¼šç”¨æˆ·é€‰æ‹©ç¨åæ›´æ–°
1. ç”¨æˆ·å¯åŠ¨åº”ç”¨
2. ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹æ›´æ–°
3. å‘ç°æ–°ç‰ˆæœ¬ v0.5.2
4. æ˜¾ç¤ºæ›´æ–°é€šçŸ¥å¼¹çª—
5. ç”¨æˆ·é€‰æ‹©"ç¨åæé†’"
6. å¼¹çª—å…³é—­ï¼Œå·¦ä¾§æ æ˜¾ç¤ºæ›´æ–°æŒ‰é’®
7. è¯¥ç‰ˆæœ¬è¢«æ ‡è®°ä¸ºå·²å¿½ç•¥ï¼ˆæœ¬æ¬¡å¯åŠ¨ä¸å†å¼¹çª—ï¼‰
8. ç”¨æˆ·å¯ä»¥éšæ—¶ç‚¹å‡»å·¦ä¾§æ çš„æ›´æ–°æŒ‰é’®æŸ¥çœ‹æ›´æ–°ä¿¡æ¯

### åœºæ™¯3ï¼šå®šæ—¶æ£€æµ‹
1. åº”ç”¨å·²è¿è¡Œè¶…è¿‡24å°æ—¶
2. ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹æ›´æ–°
3. å¦‚æœæœ‰æ–°ç‰ˆæœ¬ï¼Œæ˜¾ç¤ºæ›´æ–°é€šçŸ¥
4. ç”¨æˆ·æŒ‰éœ€å¤„ç†

## é…ç½®å’Œè‡ªå®šä¹‰

### ä¿®æ”¹æ£€æµ‹é—´éš”

åœ¨ `useUpdateChecker.js` ä¸­ä¿®æ”¹ï¼š

```javascript
const CHECK_INTERVAL = 24 * 60 * 60 * 1000 // 24å°æ—¶ï¼ˆæ¯«ç§’ï¼‰
```

### ä¿®æ”¹å½“å‰ç‰ˆæœ¬å·

å½“å‰ç‰ˆæœ¬å·ç¡¬ç¼–ç åœ¨ `useUpdateChecker.js` ä¸­ï¼Œåº”ä¸ `package.json` ä¿æŒä¸€è‡´ï¼š

```javascript
const currentVersion = ref('0.0.1')
```

**æ³¨æ„**ï¼šæœªæ¥å¯ä»¥æ”¹è¿›ä¸ºè‡ªåŠ¨ä» `package.json` è¯»å–ç‰ˆæœ¬å·ã€‚

### ä¿®æ”¹ GitHub ä»“åº“

å¦‚æœéœ€è¦æ›´æ”¹æ£€æµ‹çš„ä»“åº“ï¼š

```javascript
const GITHUB_REPO = 'MaskerPRC/tab-hive'
```

## UI è®¾è®¡

### æ›´æ–°é€šçŸ¥å¼¹çª—
- å±…ä¸­æ˜¾ç¤ºï¼Œå¸¦æœ‰åŠé€æ˜é»‘è‰²èƒŒæ™¯é®ç½©
- ç™½è‰²å¡ç‰‡ï¼Œåœ†è§’è¾¹æ¡†ï¼Œä¼˜é›…çš„é˜´å½±æ•ˆæœ
- è¡¨æƒ…ç¬¦å· ğŸ‰ ä½œä¸ºå›¾æ ‡
- ç‰ˆæœ¬å·å¯¹æ¯”æ¸…æ™°æ˜äº†
- Release Notes å¸¦æœ‰æ»šåŠ¨æ¡ï¼Œæœ€å¤šæ˜¾ç¤º500å­—ç¬¦
- ä¸¤ä¸ªæŒ‰é’®ï¼šä¸»æ“ä½œï¼ˆæ©™è‰²ï¼‰å’Œæ¬¡è¦æ“ä½œï¼ˆç°è‰²ï¼‰
- å¹³æ»‘çš„è¿›å…¥/é€€å‡ºåŠ¨ç”»

### æ›´æ–°æŒ‰é’®
- æ©™è‰²æ¸å˜èƒŒæ™¯
- ä¸‹è½½å›¾æ ‡ + "å‘ç°æ–°ç‰ˆæœ¬" æ–‡å­—
- ç»¿è‰²å°åœ†ç‚¹ä½œä¸ºæç¤º
- æ‚¬åœæ—¶æœ‰æ”¾å¤§æ•ˆæœå’Œé˜´å½±
- å…‰æ³½æ‰«è¿‡åŠ¨ç”»

## é”™è¯¯å¤„ç†

- ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶é™é»˜å¤„ç†ï¼Œä¸å½±å“åº”ç”¨æ­£å¸¸ä½¿ç”¨
- API é™æµæ—¶è‡ªåŠ¨è·³è¿‡æœ¬æ¬¡æ£€æµ‹
- ç‰ˆæœ¬æ¯”è¾ƒå¼‚å¸¸æ—¶é»˜è®¤ä¸æç¤ºæ›´æ–°

## éšç§å’Œæ€§èƒ½

- ä»…åœ¨å¿…è¦æ—¶å‘èµ·ç½‘ç»œè¯·æ±‚
- ä½¿ç”¨ GitHub å…¬å¼€ APIï¼Œæ— éœ€è®¤è¯
- ä¸æ”¶é›†ä»»ä½•ç”¨æˆ·æ•°æ®
- æœ¬åœ°å­˜å‚¨ä»…ç”¨äºæ”¹å–„ç”¨æˆ·ä½“éªŒ

## æœªæ¥æ”¹è¿›

1. **è‡ªåŠ¨æ›´æ–°**ï¼šé›†æˆ Electron çš„è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼ˆelectron-updaterï¼‰
2. **ç‰ˆæœ¬å·è‡ªåŠ¨è¯»å–**ï¼šä» package.json è‡ªåŠ¨è¯»å–å½“å‰ç‰ˆæœ¬
3. **æ›´æ–°æ—¥å¿—å¢å¼º**ï¼šæ›´å¥½çš„ Markdown æ¸²æŸ“
4. **å¢é‡æ›´æ–°**ï¼šæ”¯æŒå¢é‡æ›´æ–°åŒ…ä¸‹è½½
5. **æ›´æ–°è¿›åº¦**ï¼šæ˜¾ç¤ºä¸‹è½½è¿›åº¦æ¡
6. **é™é»˜æ›´æ–°**ï¼šåå°è‡ªåŠ¨ä¸‹è½½ï¼Œé‡å¯æ—¶å®‰è£…

## æµ‹è¯•å»ºè®®

### æ‰‹åŠ¨æµ‹è¯•

1. **æµ‹è¯•å¯åŠ¨æ£€æµ‹**ï¼š
   - æ¸…é™¤ localStorage
   - é‡å¯åº”ç”¨
   - è§‚å¯Ÿæ˜¯å¦å¼¹å‡ºæ›´æ–°é€šçŸ¥

2. **æµ‹è¯•ç‰ˆæœ¬æ¯”è¾ƒ**ï¼š
   - ä¿®æ”¹ `currentVersion` ä¸ºæ›´ä½ç‰ˆæœ¬ï¼ˆå¦‚ `0.0.1`ï¼‰
   - é‡å¯åº”ç”¨
   - åº”è¯¥æ£€æµ‹åˆ°æœ‰æ›´æ–°

3. **æµ‹è¯•å¿½ç•¥åŠŸèƒ½**ï¼š
   - ç‚¹å‡»"ç¨åæé†’"
   - è§‚å¯Ÿå·¦ä¾§æ æ˜¯å¦æ˜¾ç¤ºæ›´æ–°æŒ‰é’®
   - ç‚¹å‡»æ›´æ–°æŒ‰é’®ï¼Œåº”é‡æ–°æ˜¾ç¤ºé€šçŸ¥

4. **æµ‹è¯•å®šæ—¶æ£€æµ‹**ï¼š
   - ä¿®æ”¹ `CHECK_INTERVAL` ä¸ºè¾ƒçŸ­æ—¶é—´ï¼ˆå¦‚ 30 ç§’ï¼‰
   - ç­‰å¾…30ç§’
   - è§‚å¯Ÿæ˜¯å¦è§¦å‘æ£€æµ‹

### è‡ªåŠ¨åŒ–æµ‹è¯•

å¯ä»¥ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–ï¼š
- ç‰ˆæœ¬æ¯”è¾ƒå‡½æ•°
- localStorage è¯»å†™
- GitHub API å“åº”è§£æ

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•ç¦ç”¨è‡ªåŠ¨æ›´æ–°æ£€æµ‹ï¼Ÿ
A: ç›®å‰éœ€è¦åœ¨ä»£ç ä¸­æ³¨é‡Šæ‰ `useUpdateChecker()` çš„è°ƒç”¨ã€‚æœªæ¥å¯ä»¥æ·»åŠ è®¾ç½®é€‰é¡¹ã€‚

### Q: æ›´æ–°æ£€æµ‹å¤±è´¥ä¼šå½±å“åº”ç”¨ä½¿ç”¨å—ï¼Ÿ
A: ä¸ä¼šã€‚æ‰€æœ‰ç½‘ç»œé”™è¯¯éƒ½ä¼šè¢«æ•è·å¹¶é™é»˜å¤„ç†ï¼Œä¸å½±å“åº”ç”¨æ­£å¸¸åŠŸèƒ½ã€‚

### Q: å¯ä»¥æ£€æµ‹ Beta ç‰ˆæœ¬å—ï¼Ÿ
A: ç›®å‰åªæ£€æµ‹æœ€æ–°çš„ç¨³å®šç‰ˆ releaseã€‚å¦‚éœ€æ£€æµ‹ pre-releaseï¼Œéœ€è¦ä¿®æ”¹ API è°ƒç”¨å‚æ•°ã€‚

### Q: ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ electron-updaterï¼Ÿ
A: å½“å‰å®ç°æ›´è½»é‡ï¼Œé€‚åˆå¿«é€Ÿé›†æˆã€‚electron-updater æ˜¯æ›´å®Œå–„çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥ä½œä¸ºæœªæ¥æ”¹è¿›æ–¹å‘ã€‚

## ç›¸å…³èµ„æº

- [GitHub Releases API æ–‡æ¡£](https://docs.github.com/en/rest/releases/releases)
- [Electron è‡ªåŠ¨æ›´æ–°æ–‡æ¡£](https://www.electronjs.org/docs/latest/api/auto-updater)
- [Semantic Versioning è§„èŒƒ](https://semver.org/)

