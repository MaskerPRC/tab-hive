# 代码功能特性总结

本文档总结了 `src` 目录下各代码文件的功能特性。

## 主文件

### App.vue
主应用组件，负责整体布局和全局状态管理。包含侧边栏配置面板、网格视图、各种对话框（下载提醒、代理管理、LLM配置、监听规则、更新通知等）的显示控制，以及应用初始化逻辑。

### main.js
应用入口文件，初始化Vue应用并挂载到DOM，配置国际化支持。

### style.css
全局样式文件，定义应用的基础样式、主题变量（主色调、悬停色等）、以及拖拽/调整大小时禁用iframe交互的样式规则。

## Composables（组合式函数）

### 核心管理类

#### useLayoutManager.js
布局管理器，提供布局的创建、删除、切换、重命名、重排序等功能。负责从localStorage加载和保存布局配置，支持多布局管理和数据持久化。

#### useWebsiteManager.js
网站管理器，提供网站的添加、删除、更新、复制等功能。处理网站的位置计算、自动排列，以及网站数据的增删改查操作。

#### useSessionManager.js
会话实例管理器，管理多个独立的浏览器会话实例。每个实例拥有独立的cookie和存储空间，支持创建、删除、重命名会话实例，并提供partition名称映射。

#### useProxyOperations.js
代理操作管理器，处理代理节点的CRUD操作和批量操作。支持代理的添加、编辑、删除、测试、导入订阅、批量启用/禁用等功能。

### 视图和交互类

#### useGridViewSetup.js
网格视图设置，初始化网格视图的核心逻辑。处理网站列表、全屏模式、画布变换、拖拽调整等状态管理。

#### useGridEventHandlers.js
网格事件处理器，处理网格视图中的各种用户交互事件，包括鼠标移动、拖拽、点击等事件的处理逻辑。

#### useFullscreen.js
全屏模式管理，处理全屏显示和退出逻辑。管理全屏工具栏的显示/隐藏，支持自动隐藏和鼠标悬停显示。

#### useFullscreenNavigation.js
全屏导航功能，在全屏模式下提供前进、后退、刷新等浏览器导航功能。

#### useCanvasTransform.js
画布变换管理，处理画布的缩放、平移、重置等变换操作。支持鼠标滚轮缩放、拖拽平移等功能。

#### useCanvasEventHandlers.js
画布事件处理器，处理画布上的各种鼠标和键盘事件，包括点击、拖拽、缩放等交互。

#### useViewportStates.js
视口状态管理，管理侧边栏的显示/隐藏状态，以及视口相关的UI状态。

### 拖拽和调整大小

#### useDrag.js
通用拖拽功能，提供可拖拽元素的位置管理和事件处理。支持鼠标拖拽移动元素位置。

#### useItemDrag.js
卡片拖拽功能，处理网格项目的拖拽移动逻辑。支持碰撞检测、自动推挤、网格对齐等功能。

#### useItemResize.js
卡片调整大小功能，处理网格项目的尺寸调整逻辑。支持八个方向的调整手柄，碰撞检测和自动推挤。

#### useCollisionDetection.js
碰撞检测功能，检测网格项目之间的重叠和碰撞。提供矩形碰撞检测、碰撞边距计算等功能。

#### collisionPushAlgorithm.js
碰撞推挤算法，当拖拽或调整大小时发生碰撞，自动推挤其他元素以避免重叠。

### 绘制功能

#### useDrawing.js
绘制功能管理，处理画布上的自由绘制功能。支持画笔、文字、图片三种绘制工具，使用perfect-freehand库实现平滑笔触。

#### useDoubleBuffer.js
双缓冲绘制优化，用于提高绘制性能，减少绘制时的闪烁和卡顿。

### Webview和Iframe管理

#### useWebview.js
Webview/Iframe管理核心，负责webview和iframe的引用管理、事件监听、生命周期管理。处理代理设置、证书错误、URL变化等。

#### useWebviewSetup.js
Webview设置功能，处理webview的初始化、加载、刷新等操作。管理webview的创建和配置。

#### useWebviewAudio.js
Webview音频管理，处理webview中音频的静音/取消静音功能，支持全局静音控制。

#### useWebviewDevTools.js
Webview开发者工具，提供打开/关闭webview开发者工具的功能。

#### useCustomHtmlWebview.js
自定义HTML Webview管理，处理自定义HTML内容的webview显示和编辑。

#### useWebviewSelector.js
Webview选择器功能，在webview中应用CSS选择器，只显示选中的元素，隐藏其他内容。

#### useIframeSelector.js
Iframe选择器功能，在iframe中应用元素选择器，用于提取和显示特定元素。

#### useElementSelection.js
元素选择功能，提供在网页中选择DOM元素的能力，用于自动化配置。

#### useSelectorValidator.js
选择器验证器，验证CSS选择器的有效性，确保选择器能够正确匹配元素。

### 自动化相关

#### useAutomationData.js
自动化数据管理，管理网站的自动化配置数据（数据映射、交互映射等）。提供数据的增删改查和持久化。

#### useWorkflowView.js
工作流视图管理，提供工作流编辑视图的模式切换（正常视图/自动化视图），管理工作流相关的状态。

### 监听和监控

#### useMonitoringRules.js
监听规则管理，管理网站的监听规则。提供规则数量的加载和显示，以及打开监听设置的功能。

#### useMonitoringState.js
监听状态管理，管理监听规则的启用/禁用状态，以及监听相关的全局状态。

#### useMonitoringRuleForm.js
监听规则表单管理，处理监听规则的表单数据、验证和提交逻辑。

#### useMonitoringHandlers.js
监听处理器，处理监听规则相关的用户操作，包括创建、编辑、删除、启用/禁用等。

#### useUrlChangeDetector.js
URL变化检测器，检测webview中URL的变化，用于触发相应的处理逻辑。

### 代理相关

#### useProxySessionSync.js
代理会话同步，同步网站的代理设置和会话实例设置，确保代理配置正确应用到对应的会话。

### 布局操作

#### useLayoutOperations.js
布局操作功能，提供布局的导入、导出、分享等功能。处理布局数据的序列化和反序列化。

#### useLayoutHandlers.js
布局处理器，处理布局相关的用户操作，包括切换、创建、删除、重命名等。

#### useLayoutShareExport.js
布局分享导出功能，处理布局的分享到云端和从云端导入的功能。

#### useSharedLayouts.js
共享布局管理，管理从云端获取的共享布局列表，支持搜索、排序等功能。

#### useSharedLayoutHandlers.js
共享布局处理器，处理共享布局的导入、搜索、排序等操作。

#### useImportExport.js
导入导出功能，处理布局和网站数据的导入导出。支持JSON格式和图片格式（嵌入布局数据）。

### 对话框管理

#### useDialogStates.js
对话框状态管理，统一管理所有对话框/弹窗的显示状态。包括下载模态框、代理管理、LLM配置、Session管理、监听规则、内容脚本面板等。

#### useDialog.js
对话框功能，提供通用的对话框显示功能，支持alert、confirm、prompt等类型的对话框。

### 表单和配置

#### useWebsiteForm.js
网站表单管理，管理网站编辑表单的数据和验证逻辑。处理表单字段的绑定和提交。

#### useWebsiteHandlers.js
网站处理器，处理网站相关的用户操作，包括添加、编辑、删除、复制等。

#### useWebsiteOperations.js
网站操作功能，提供网站的高级操作功能，如刷新、全屏、编辑等。

#### useQuickAdd.js
快速添加功能，提供快速添加网站的简化流程，支持从URL快速创建网站。

### 高级功能

#### useAdvancedSection.js
高级功能区域管理，管理网站编辑对话框中的高级功能区域的展开/折叠状态。

#### useSpecialWebsiteTypes.js
特殊网站类型处理，处理特殊类型的网站（如桌面捕获、自定义HTML等）的显示和配置。

#### useCredentialManager.js
凭证管理器，管理网站的登录凭证（用户名、密码等），提供安全的凭证存储和自动填充。

#### useContentScriptExecutor.js
内容脚本执行器，在webview中执行自定义JavaScript代码，支持代码编辑和执行。

### 更新和通知

#### useUpdateChecker.js
更新检测功能，通过GitHub releases API检测应用更新。支持启动时检测、定时检测（每24小时）、版本比较和更新通知。

#### useUpdateHandlers.js
更新处理器，处理更新相关的用户操作，包括下载更新、安装更新、忽略更新等。

### LLM相关

#### useLlmConfig.js
LLM配置管理，管理LLM API的配置信息（API地址、密钥等），提供配置的保存和加载。

#### useLlmGenerator.js
LLM HTML生成器，使用LLM API根据用户需求生成HTML代码。支持完整的HTML页面生成。

#### useAIChartGenerator.js
AI图表生成器，使用AI生成图表配置和数据，用于数据可视化。

### 文件操作

#### useFileDrop.js
文件拖放功能，处理文件的拖放操作，支持从文件系统拖放文件到应用中。

#### useUrlDrop.js
URL拖放功能，处理URL的拖放操作，支持从浏览器或其他应用拖放URL链接。

### 其他功能

#### useKeyboardShortcuts.js
键盘快捷键管理，处理画布的键盘快捷键。支持缩放、平移、全屏、添加网站等快捷键操作。

#### useModifierKey.js
修饰键检测，检测键盘修饰键（Ctrl、Shift、Alt等）的按下状态，用于组合快捷键。

#### useNavigation.js
导航功能，提供网页导航功能，包括前进、后退、刷新等。

#### useRefreshInterval.js
刷新间隔管理，管理网站的自动刷新间隔设置和定时刷新逻辑。

#### useAutoRefresh.js
自动刷新功能，提供iframe定时刷新功能。支持设置刷新间隔、暂停/恢复、倒计时显示等。

#### useCertificateError.js
证书错误处理，处理webview中的SSL证书错误，提供证书错误覆盖层的显示和用户操作。

#### useCertificateStorage.js
证书存储管理，管理用户信任的证书，提供证书的保存和验证功能。

#### useExternalUrlModal.js
外部链接模态框管理，处理外部链接的打开确认，防止意外跳转到外部网站。

#### useDownloadModalHandlers.js
下载模态框处理器，处理下载相关的用户操作，包括显示下载提醒、关闭提醒等。

#### useGlobalSettingsHandlers.js
全局设置处理器，处理全局设置的更改，包括显示标题、全局静音、广告拦截、自定义代码等。

#### useOverlayClick.js
遮罩层点击处理，处理对话框遮罩层的点击事件，用于关闭对话框。

#### useGridDialogs.js
网格对话框管理，管理网格视图中的各种对话框，包括重排对话框、导入对话框等。

#### useGridLayout.js
网格布局计算，计算网格中网站卡片的位置和大小，处理网格布局的算法。

## Components（组件）

### 核心视图组件

#### GridView.vue
网格视图主组件，应用的核心视图组件。负责显示网站卡片网格、处理全屏模式、画布变换、拖拽调整、绘制功能、自动化视图、工作流节点等。是整个应用的主要交互界面。

#### GridWebsiteList.vue
网站卡片列表组件，负责渲染和管理所有网站卡片。处理卡片的显示、拖拽状态、调整大小状态等。

#### WebsiteCard.vue
网站卡片组件，单个网站的显示容器。集成webview、拖拽手柄、调整大小手柄、标题栏、自动化面板等功能。是网站显示的核心组件。

#### CanvasView.vue
画布视图组件，提供画布的显示和交互功能，支持缩放、平移等操作。

#### CanvasControls.vue
画布控制组件，提供画布的控制按钮，包括缩放、重置、自动排列、重排、绘制工具等。

#### CanvasContextMenu.vue
画布右键菜单，提供画布上的右键菜单功能，包括添加网站、粘贴等操作。

### 网站编辑相关

#### WebsiteEditDialog.vue
网站编辑对话框，完整的网站配置对话框。包含基础信息、代理设置、会话实例、设备类型、自动刷新、音频视觉设置、高级功能等所有配置选项。

#### WebsiteBasicInfo.vue
网站基础信息组件，网站编辑对话框中的基础信息输入部分，包括标题和URL输入。

#### TargetSelectorList.vue
目标选择器列表，显示和管理网站的元素选择器列表，用于自动化配置。

#### SessionInstanceSelector.vue
会话实例选择器，选择网站使用的会话实例，用于数据隔离。

#### ProxySelector.vue
代理选择器，选择网站使用的代理节点。

#### DeviceTypeSelector.vue
设备类型选择器，选择网站模拟的设备类型（桌面、平板、手机等）。

#### AutoRefreshConfig.vue
自动刷新配置，配置网站的自动刷新间隔和选项。

#### AudioVisualSettings.vue
音频视觉设置，配置网站的音频和视觉相关设置。

#### PaddingConfig.vue
内边距配置，配置网站显示时的内边距设置。

### 网站卡片子组件

#### WebsiteCardTitleBar.vue
网站卡片标题栏，显示网站的标题和控制按钮（编辑、全屏、删除、更多菜单等）。

#### WebsiteCardContentNormal.vue
网站卡片正常内容，显示正常的webview内容。

#### WebsiteCardContentCustomHtml.vue
网站卡片自定义HTML内容，显示自定义HTML内容。

#### WebsiteCardMoreMenu.vue
网站卡片更多菜单，提供网站卡片的更多操作菜单（复制、删除、刷新等）。

#### WebsiteAutomationPanel.vue
网站自动化面板，显示和管理网站的自动化配置（数据映射、交互映射），用于工作流配置。

### 布局管理

#### ConfigPanel.vue
配置面板，应用的侧边栏配置面板。包含布局列表、设置开关、操作按钮等。是应用的主要控制中心。

#### LayoutList.vue
布局列表组件，显示和管理所有布局，支持创建、删除、切换、重命名等操作。

#### LayoutDropdown.vue
布局下拉菜单，提供布局选择的下拉菜单组件。

#### SharedLayoutModal.vue
共享布局模态框，显示和管理从云端获取的共享布局，支持搜索、排序、导入等功能。

### 代理管理

#### ProxyManager.vue
代理管理器，代理节点管理的主界面。提供代理列表、添加、编辑、删除、测试、导入订阅、批量操作等功能。

#### ProxyTable.vue
代理表格组件，显示代理节点的表格，支持选择、排序、筛选等功能。

#### ProxyEditDialog.vue
代理编辑对话框，用于添加或编辑代理节点的配置信息。

#### ProxyImportDialog.vue
代理导入对话框，用于从订阅链接导入代理节点。

### 监听和监控

#### MonitoringRulesList.vue
监听规则列表，显示网站的所有监听规则，支持创建、编辑、删除、启用/禁用等操作。

#### MonitoringRuleDialog.vue
监听规则对话框，用于创建或编辑监听规则的配置。

### 对话框和模态框

#### Dialog.vue
通用对话框组件，提供alert、confirm、prompt等类型的对话框。

#### DownloadModal.vue
下载模态框，提醒用户下载浏览器插件或客户端。

#### ExternalUrlModal.vue
外部链接模态框，当用户点击外部链接时显示确认对话框。

#### ImportModeDialog.vue
导入模式选择对话框，选择布局导入的方式（JSON文件、图片文件等）。

#### CustomHtmlDialog.vue
自定义HTML对话框，用于编辑网站的自定义HTML内容。

#### LlmConfigDialog.vue
LLM配置对话框，用于配置LLM API的相关设置。

#### TestLLMDialog.vue
LLM测试对话框，用于测试LLM API的连接和功能。

#### RearrangeDialog.vue
重排对话框，用于重新排列网站卡片的位置。

### 全屏和导航

#### FullscreenBar.vue
全屏工具栏，在全屏模式下显示的顶部工具栏，包含退出、前进、后退、刷新、元素选择等按钮。

#### UrlChangeHint.vue
URL变化提示，当webview中的URL发生变化时显示提示信息。

### 元素选择

#### ElementSelector.vue
元素选择器组件，提供在网页中选择DOM元素的功能。支持鼠标悬停高亮、点击选择等交互。

#### ElementHighlighter.vue
元素高亮器，在元素选择过程中高亮显示当前悬停的元素。

#### SelectorToolbar.vue
选择器工具栏，提供元素选择时的工具栏，包含确认、取消等按钮。

#### SelectorList.vue
选择器列表，显示已选择的选择器列表。

#### SelectorSettings.vue
选择器设置，配置选择器的相关设置。

#### ElementInfo.vue
元素信息显示，显示选中元素的详细信息（标签名、ID、类名等）。

### 绘制相关

#### GridDrawingLayer.vue
网格绘制层，在画布上显示绘制的内容（画笔、文字、图片等）。

### 工作流相关

#### WorkflowNode.vue
工作流节点组件，显示工作流中的节点（网页节点、HTTP节点、Set节点、Web Action节点等）。支持节点连接、配置编辑等功能。

#### WorkflowCanvasToolbar.vue
工作流画布工具栏，提供工作流编辑时的工具栏，包含添加节点、执行工作流等按钮。

#### AutomationContextMenu.vue
自动化右键菜单，在自动化视图中提供右键菜单功能，包括添加节点、删除节点等操作。

### 其他功能组件

#### AddWebsiteButton.vue
添加网站按钮，提供快速添加网站的按钮组件。

#### DropZone.vue
拖放区域，提供文件或URL的拖放区域，支持拖放提示和拖放处理。

#### DragHandle.vue
拖拽手柄，网站卡片上的拖拽手柄，用于拖拽移动网站卡片。

#### ResizeHandles.vue
调整大小手柄，网站卡片上的调整大小手柄，用于调整网站卡片的大小。

#### RefreshTimer.vue
刷新计时器，显示自动刷新的倒计时。

#### CertificateErrorOverlay.vue
证书错误覆盖层，当webview出现SSL证书错误时显示的覆盖层，提供继续访问或返回的选项。

#### ContentScriptPanel.vue
内容脚本面板，提供在webview中执行自定义JavaScript代码的面板，支持代码编辑和执行。

#### SessionInstanceManager.vue
会话实例管理器，管理所有会话实例的对话框，支持创建、删除、重命名会话实例。

#### CredentialManager.vue
凭证管理器，管理网站登录凭证的组件，支持添加、编辑、删除凭证。

#### LanguageSelector.vue
语言选择器，提供应用语言选择的组件。

#### UpdateButton.vue
更新按钮，显示更新提示的按钮组件。

#### UpdateNotification.vue
更新通知组件，显示应用更新通知，包括新版本信息、更新内容、下载进度等。

#### WindowManagement.vue
窗口管理组件，管理应用窗口的功能（如单网站窗口模式等）。

#### DesktopCaptureSelector.vue
桌面捕获选择器，选择要捕获的桌面窗口或屏幕区域。

#### DesktopCaptureView.vue
桌面捕获视图，显示捕获的桌面内容。

#### DesktopCaptureEditDialog.vue
桌面捕获编辑对话框，编辑桌面捕获网站的配置。

#### SimpleChart.vue
简单图表组件，用于数据可视化的简单图表组件。

#### SwitchItem.vue
开关项组件，提供开关样式的设置项组件。

#### IconButton.vue
图标按钮组件，提供带图标的按钮组件。

#### FloatingActions.vue
浮动操作按钮，提供浮动在页面上的操作按钮。

#### GridDialogManager.vue
网格对话框管理器，管理网格视图中的各种对话框的显示和交互。

## Utils（工具函数）

### adBlockUtils.js
去广告工具函数，提供全面的广告拦截功能。生成去广告脚本代码，通过CSS隐藏、MutationObserver动态移除、拦截网络请求等方式拦截广告。支持移除去广告功能的代码生成。

### domainUtils.js
域名工具函数，用于判断两个URL是否同根域名。提供根域名提取、同根域名判断等功能，支持特殊TLD（如.co.uk）的处理。

### layoutImageUtils.js
布局图片工具函数，用于截图、嵌入布局JSON到图片元数据、从图片提取布局JSON。支持使用html2canvas截图、PNG tEXt块存储JSON数据、从图片提取布局数据等功能。

### webviewSelectorUtils.js
Webview选择器工具函数，提供在webview中执行的选择器相关功能。支持应用CSS选择器到页面（只显示选中元素）、恢复原始样式、生成选择器应用代码等功能。

## Models（数据模型）

### workflowModels.js
工作流节点数据模型，定义工作流系统的数据模型。包括节点类型（网页节点、Flow节点、HTTP节点、Set节点、Web Action节点等）、连接类型（数据映射、执行流、交互控制）、数据映射类型、交互映射类型，以及创建各种节点和连接的工厂函数。


